<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    <%@page import="java.util.Enumeration"%>
<%@page import="com.oreilly.servlet.multipart.DefaultFileRenamePolicy"%>
<%@page import="com.oreilly.servlet.MultipartRequest"%>

<%
	String id = "";
	String subject = "";
	String fileName ="";
	String orgfileName = "";
	
	//upload 폴더명 
	String uploadPath = request.getRealPath("upload");
	
	//폴더의 경로를 구해옴
	out.println(uploadPath);
	
	try{
		MultipartRequest multi = new MultipartRequest(
				//MultipartRequest 인스턴스 생성(cos.jar의 라이브러리)
				request,
				uploadPath,
				1024*1024*10,	//첨부파일 최대 용량 설정(bite)/10kb/d용량 초과
				"utf-8",	//인코딩 방식 지정
				new DefaultFileRenamePolicy()	//중복 파일 처리
				
				);
				id = multi.getParameter("id");	//form의 name="id"인 값을 구함
				subject = multi.getParameter("subject");	
				// form의 name="subject" 인 값을 구함
					
				/* form의 <input type="file"> name값을 모를 경우 name을 구할때 사용
				Enumeration files=multi.getFileNames(); // form의 type="file" name을 구함
				String file1 =(String)files.nextElement(); // 첫번째 type="file"의 name 저장
				String file2 =(String)files.nextElement(); // 두번째 type="file"의 name 저장
				*/
				fileName = multi.getFilesystemName("file");
				orgfileName = multi.getOriginalFileName("file");
	}catch(Exception e){
		e.getStackTrace();
	}	//업로드 종류


%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<%=id%>
<form action="check.jsp" method="post">
		<input type="hidden" name="id" value="<%=id%>"> 
		<input type="hidden" name="subject" value="<%=subject%>"> 
		<input type="hidden" name="fileName" value="<%=fileName%>">  
		<input type="hidden" name="orgfileName" value="<%=orgfileName%>">
		<input type="submit" value="업로드 확인">
	</form>
</body>
</html>